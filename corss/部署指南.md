# Baseåˆ°Aptos CCTPè·¨é“¾æ¡¥éƒ¨ç½²æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„Baseæµ‹è¯•ç½‘åˆ°Aptosæµ‹è¯•ç½‘çš„CCTPï¼ˆCross-Chain Transfer Protocolï¼‰è·¨é“¾æ¡¥å®ç°ï¼Œæ”¯æŒUSDCçš„è·¨é“¾è½¬è´¦ã€‚

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
corss1.0/
â”œâ”€â”€ sources/                    # Moveåˆçº¦æºç 
â”‚   â”œâ”€â”€ cctp_receiver.move     # CCTPæ¥æ”¶åˆçº¦
â”‚   â””â”€â”€ cctp_config.move       # é…ç½®å¸¸é‡
â”œâ”€â”€ src/                       # TypeScriptæºç 
â”‚   â”œâ”€â”€ base-sender.ts         # Baseé“¾å‘é€å™¨
â”‚   â”œâ”€â”€ circle-attestation.ts  # Circleç­¾åè·å–
â”‚   â”œâ”€â”€ aptos-receiver.ts      # Aptosæ¥æ”¶å™¨
â”‚   â””â”€â”€ cross-chain-orchestrator.ts # è·¨é“¾ç¼–æ’å™¨
â”œâ”€â”€ examples/                  # ç¤ºä¾‹ä»£ç 
â”‚   â””â”€â”€ complete-example.ts    # å®Œæ•´ç¤ºä¾‹
â”œâ”€â”€ Move.toml                  # Moveé¡¹ç›®é…ç½®
â”œâ”€â”€ package.json               # Node.jsä¾èµ–
â””â”€â”€ éƒ¨ç½²æŒ‡å—.md                # æœ¬æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

#### å®‰è£…ä¾èµ–
```bash
# å®‰è£…Node.jsä¾èµ–
npm install

# å®‰è£…Aptos CLI
curl -fsSL "https://aptos.dev/scripts/install_cli.py" | python3
```

#### ç½‘ç»œè¦æ±‚
- **Base Sepoliaæµ‹è¯•ç½‘**: éœ€è¦æµ‹è¯•ETHå’ŒUSDC
- **Aptosæµ‹è¯•ç½‘**: éœ€è¦æµ‹è¯•APTä½œä¸ºgasè´¹

### 2. è·å–æµ‹è¯•èµ„é‡‘

#### Base Sepoliaæµ‹è¯•ç½‘
1. **è·å–æµ‹è¯•ETH**: https://www.alchemy.com/faucets/base-sepolia
2. **è·å–æµ‹è¯•USDC**: https://faucet.circle.com/ (é€‰æ‹©Base Sepolia)

#### Aptosæµ‹è¯•ç½‘
1. **è·å–æµ‹è¯•APT**: https://aptoslabs.com/testnet-faucet

### 3. éƒ¨ç½²Moveåˆçº¦

```bash
# åˆå§‹åŒ–Aptosè´¦æˆ·ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
aptos init

# ç¼–è¯‘Moveåˆçº¦
aptos move compile

# éƒ¨ç½²åˆ°Aptosæµ‹è¯•ç½‘
aptos move publish
```

> âš ï¸ **é‡è¦**: éƒ¨ç½²æˆåŠŸåï¼Œæ›´æ–° `src/aptos-receiver.ts` ä¸­çš„ `CROSS_CHAIN_MODULE_ADDRESS` ä¸ºå®é™…éƒ¨ç½²åœ°å€

### 4. é…ç½®å‚æ•°

ç¼–è¾‘ `examples/complete-example.ts` ä¸­çš„é…ç½®ï¼š

```typescript
const CONFIG = {
  BASE_PRIVATE_KEY: 'your_base_private_key_here',
  APTOS_PRIVATE_KEY: 'your_aptos_private_key_here',
  APTOS_RECIPIENT: 'your_aptos_address_here',
  USDC_AMOUNT: '1.0',
};
```

### 5. è¿è¡Œç¤ºä¾‹

```bash
# åˆ›å»ºAptosæµ‹è¯•è´¦æˆ·
npm run example create-account

# æ£€æŸ¥ä½™é¢
npm run example balance

# æ‰§è¡Œè·¨é“¾è½¬è´¦
npm run example cross-chain
```

## ğŸ“– è¯¦ç»†ä½¿ç”¨è¯´æ˜

### Moveåˆçº¦æ¥å£

#### `cctp_receiver::receive_cctp_usdc`
```move
public entry fun receive_cctp_usdc(
    account: &signer,
    message_bytes: vector<u8>,
    attestation: vector<u8>
)
```

- **åŠŸèƒ½**: æ¥æ”¶CCTPæ¶ˆæ¯å¹¶é“¸é€ USDC
- **å‚æ•°**:
  - `account`: æ¥æ”¶è€…è´¦æˆ·
  - `message_bytes`: Baseé“¾ç”Ÿæˆçš„è·¨é“¾æ¶ˆæ¯
  - `attestation`: Circleæä¾›çš„ç­¾åè¯æ˜

#### `cctp_receiver::receive_cctp_and_add_liquidity` (é¢„ç•™)
```move
public entry fun receive_cctp_and_add_liquidity(
    account: &signer,
    message_bytes: vector<u8>,
    attestation: vector<u8>,
    pool_address: address,
    liquidity_amount: u64
)
```

- **åŠŸèƒ½**: æ¥æ”¶USDCå¹¶æ·»åŠ æµåŠ¨æ€§ï¼ˆé¢„ç•™æ¥å£ï¼‰
- **çŠ¶æ€**: ğŸš§ å¾…å®ç°

### TypeScript API

#### BaseCCTPSender
```typescript
import { BaseCCTPSender } from './src/base-sender';

const sender = new BaseCCTPSender();

// æ‰§è¡Œè·¨é“¾å‘é€
const result = await sender.executeFullCrossChain({
  amount: '10.0',
  recipientAddress: 'aptos_address',
  signer: ethers_signer
});
```

#### AptosCCTPReceiver
```typescript
import { aptosCCTPReceiver } from './src/aptos-receiver';

// æ¥æ”¶CCTP USDC
const result = await aptosCCTPReceiver.receiveCCTPUSDC({
  messageBytes: 'message_from_base',
  attestation: 'circle_signature',
  recipientPrivateKey: 'aptos_private_key'
});
```

#### CrossChainOrchestrator (æ¨è)
```typescript
import { crossChainOrchestrator } from './src/cross-chain-orchestrator';

// ä¸€é”®å®Œæˆæ•´ä¸ªè·¨é“¾æµç¨‹
const result = await crossChainOrchestrator.executeCrossChain({
  amount: '10.0',
  recipientAddress: 'aptos_address',
  baseSigner: ethers_signer,
  aptosPrivateKey: 'aptos_key',
  onProgress: (step, details) => console.log(step)
});
```

## ğŸ”§ æŠ€æœ¯åŸç†

### è·¨é“¾æµç¨‹
1. **Baseé“¾**: è°ƒç”¨ `depositForBurn` çƒ§æ¯USDCï¼Œç”Ÿæˆè·¨é“¾æ¶ˆæ¯
2. **Circle**: éªŒè¯æ¶ˆæ¯å¹¶æä¾›ç­¾åè¯æ˜ (attestation)
3. **Aptosé“¾**: éªŒè¯ç­¾åå¹¶é“¸é€ USDCåˆ°æŒ‡å®šåœ°å€

### å®‰å…¨æœºåˆ¶
- **Circleç­¾åéªŒè¯**: é˜²æ­¢ä¼ªé€ è·¨é“¾æ¶ˆæ¯
- **Nonceé˜²é‡æ”¾**: ç¡®ä¿æ¶ˆæ¯ä¸è¢«é‡å¤å¤„ç†
- **åŸå­æ“ä½œ**: Moveåˆçº¦ç¡®ä¿æ¥æ”¶å’Œå¤„ç†åœ¨åŒä¸€äº¤æ˜“ä¸­å®Œæˆ

## ğŸ” æµ‹è¯•å’Œè°ƒè¯•

### ç¼–è¯‘æ£€æŸ¥
```bash
# Moveåˆçº¦ç¼–è¯‘
aptos move compile

# TypeScriptç¼–è¯‘
npm run build
```

### å•å…ƒæµ‹è¯•
```bash
# Moveåˆçº¦æµ‹è¯•
aptos move test

# TypeScriptæµ‹è¯•
npm run test
```

### è°ƒè¯•æŠ€å·§
1. **æŸ¥çœ‹äº¤æ˜“**: åœ¨ [Base Sepolia Explorer](https://sepolia.basescan.org/) å’Œ [Aptos Explorer](https://explorer.aptoslabs.com/) æŸ¥çœ‹äº¤æ˜“è¯¦æƒ…
2. **ç›‘æ§äº‹ä»¶**: åˆçº¦ä¼šå‘å‡ºäº‹ä»¶ï¼Œä¾¿äºè¿½è¸ªçŠ¶æ€
3. **Circle API**: å¯ä»¥ç›´æ¥æŸ¥è¯¢ Circle API è·å–ç­¾åçŠ¶æ€

## âš ï¸ æ³¨æ„äº‹é¡¹

### é‡è¦æé†’
1. **ä»…ç”¨äºæµ‹è¯•ç½‘**: å½“å‰é…ç½®ä»…é€‚ç”¨äºæµ‹è¯•ç¯å¢ƒ
2. **ç§é’¥å®‰å…¨**: ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¡¬ç¼–ç ç§é’¥
3. **ç½‘ç»œç¨³å®š**: è·¨é“¾éœ€è¦ç½‘ç»œè¿æ¥ç¨³å®šï¼Œå»ºè®®åœ¨è‰¯å¥½ç½‘ç»œç¯å¢ƒä¸‹æ“ä½œ
4. **Gasè´¹å‡†å¤‡**: ç¡®ä¿ä¸¤æ¡é“¾éƒ½æœ‰è¶³å¤Ÿçš„gasè´¹

### å¸¸è§é—®é¢˜
1. **"USDCä½™é¢ä¸è¶³"**: è¯·åˆ°Circle faucetè·å–æµ‹è¯•USDC
2. **"Aptosè´¦æˆ·ä¸å­˜åœ¨"**: è¯·å…ˆåˆ°faucetè·å–æµ‹è¯•APTæ¿€æ´»è´¦æˆ·
3. **"Circleç­¾åè¶…æ—¶"**: ç­‰å¾…æ—¶é—´è¾ƒé•¿æ˜¯æ­£å¸¸çš„ï¼Œé€šå¸¸1-3åˆ†é’Ÿ

## ğŸ”„ åç»­æ‰©å±•

### è®¡åˆ’åŠŸèƒ½
1. **æµåŠ¨æ€§æ·»åŠ **: è·¨é“¾åè‡ªåŠ¨æ·»åŠ åˆ°DEXæµåŠ¨æ€§æ± 
2. **å¤šé“¾æ”¯æŒ**: æ”¯æŒæ›´å¤šEVMé“¾åˆ°Aptosçš„è·¨é“¾
3. **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡è·¨é“¾è½¬è´¦
4. **Webç•Œé¢**: æä¾›ç”¨æˆ·å‹å¥½çš„Webç•Œé¢

### é›†æˆæŒ‡å—
```typescript
// é›†æˆåˆ°ç°æœ‰é¡¹ç›®
import { crossChainOrchestrator } from 'base-aptos-cctp-bridge';

// åœ¨ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨
const bridge = crossChainOrchestrator;
const result = await bridge.executeCrossChain(params);
```

## ğŸ“ æ”¯æŒå’Œåé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ä»£ç æ³¨é‡Šå’Œé”™è¯¯æ—¥å¿—
2. æ£€æŸ¥ç½‘ç»œé…ç½®å’Œä½™é¢
3. å‚è€ƒCircleå®˜æ–¹æ–‡æ¡£
4. æäº¤Issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

---

ğŸ‰ **æ­å–œï¼** ä½ ç°åœ¨å¯ä»¥åœ¨Baseå’ŒAptosä¹‹é—´è‡ªç”±è½¬ç§»USDCäº†ï¼